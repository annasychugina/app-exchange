(this["webpackJsonpexchange-app"]=this["webpackJsonpexchange-app"]||[]).push([[0],{133:function(e,n,r){},134:function(e,n,r){},135:function(e,n,r){},136:function(e,n,r){"use strict";r.r(n);var t,a=r(0),c=r.n(a),o=r(9),u=r.n(o),i=r(12),l=r(25),s=r(69),d=r(70),m=r(15),E=r(16),f=r(71),y=r.n(f);!function(e){e.RATES_REQUEST="RATES_REQUEST",e.RATES_RESPONSE_SUCCESS="RATES_RESPONSE_SUCCESS",e.RATES_RESPONSE_ERROR="RATES_RESPONSE_ERROR"}(t||(t={}));var b,_=function(e){return function(n,r){var a=r().rates[e];if(!a||!a.loading)return n(function(e){return{payload:{currency:e},type:t.RATES_REQUEST}}(e)),function(e){return y.a.get("https://api.exchangeratesapi.io/latest",{params:{base:e}}).then((function(e){if(200!==e.status)throw new Error("Error request exchangerates api");return e.data}))}(e).then((function(r){var a=r.rates;n(function(e,n){return{payload:{currency:e,rates:n},type:t.RATES_RESPONSE_SUCCESS}}(e,a))})).catch((function(){return n(function(e){return{payload:{currency:e},type:t.RATES_RESPONSE_ERROR}}(e))}))}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case t.RATES_REQUEST:var r=n.payload.currency;return Object(E.a)({},e,Object(m.a)({},r,Object(E.a)({},e[r],{loading:!0})));case t.RATES_RESPONSE_SUCCESS:var a=n.payload,c=a.currency,o=a.rates;return Object(E.a)({},e,Object(m.a)({},c,Object(E.a)({},e[c],{rates:o,loaded:!0,loading:!1})));case t.RATES_RESPONSE_ERROR:var u=n.payload.currency;return Object(E.a)({},e,Object(m.a)({},u,Object(E.a)({},e[u],{loading:!1})));default:return e}},h=r(72);!function(e){e.EXCHANGE_MONEY="EXCHANGE_MONEY"}(b||(b={}));var p,v=r(52);!function(e){e.ADD_NOTIFICATION="ADD_NOTIFICATION",e.RESET_NOTIFICATIONS="RESET_NOTIFICATIONS"}(p||(p={}));var O,S=function(e){return{type:p.ADD_NOTIFICATION,payload:e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case p.ADD_NOTIFICATION:return[].concat(Object(v.a)(e),Object(v.a)(n.payload));case p.RESET_NOTIFICATIONS:return[];default:return e}},x=Object(d.composeWithDevTools)({}),C=[s.a],R=function(){return Object(l.createStore)(Object(l.combineReducers)({userBalance:(e=h,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case b.EXCHANGE_MONEY:var t,a=r.payload,c=a.currencyFrom,o=a.currencyTo,u=a.form;return u.currencyFrom&&u.currencyTo?Object(E.a)({},n,(t={},Object(m.a)(t,c,n[c]-u.currencyFrom),Object(m.a)(t,o,n[o]+u.currencyTo),t)):n;default:return n}}),rates:g,notifications:T}),x(l.applyMiddleware.apply(void 0,C)));var e}(),N=r(38),j=r(21),F=["RUB","USD","EUR","GBP"],I={RUB:"\u20bd",USD:"$",EUR:"\u20ac",GBP:"\xa3"};!function(e){e.currencyFrom="currencyFrom",e.currencyTo="currencyTo"}(O||(O={}));var k=r(6),A=r.n(k),w=r(73),B=r(74),U=r.n(B),V=function(e){var n=e.onChange,r=e.prefix,t=e.inputValue,o=void 0===t?"":t,u=e.name,i=Object(a.useCallback)((function(e){var t=e.value,a="-"===r?t.slice(1):t;+a!==(o?+o:0)&&n(+a,u)}),[n,u,r,o]);return c.a.createElement(w.a,{className:U.a.input,allowNegative:!1,decimalScale:2,maxLength:12,name:u,prefix:r,value:o,thousandSeparator:" ",autoComplete:"off",onValueChange:i})},D=r(75),M=r.n(D),P=(r(131),r(132),r(133),r(76)),G=r.n(P),W={dots:!0,arrows:!0,infinite:!1,speed:260},X=function(e){var n=e.currentSlide,r=e.children,t=e.onSlideChange,o=Object(a.useRef)(null);return Object(a.useEffect)((function(){o.current&&o.current.slickGoTo(n)}),[n]),c.a.createElement(M.a,Object.assign({},W,{ref:o,initialSlide:n,afterChange:t}),r.map((function(e,n){return c.a.createElement("div",{className:G.a.slide,key:n},e)})))},Y=function(e,n){return e.replace(/%.+?%/g,(function(e){var r=e.replace(/\W/g,"");return n[r]}))},L=function(e){return Math.round(100*e)/100},H=function(e,n){var r=n.toString(),t=r.length<=4?r:r.replace(/\B(?=(\d{3})+(?!\d))/g,"\xa0");return"".concat(e?"".concat(I[e]):"").concat(t)},J=r(50),Q=r(7),q=r.n(Q),Z=function(e){var n=e.currencyItems,r=e.rate,t=e.currency,a=e.onCurrencyChange,o=e.onCurrencyValueChange,u=e.type,i=e.inputValue,l=e.balance,s=e.currencyAmountStr,d=e.isRateLoading,m=void 0!==d&&d;return console.log("rate",r),c.a.createElement("div",{className:A()(q.a.root,q.a["root_".concat(u)])},c.a.createElement(X,{onSlideChange:function(e){a(n[e])},currentSlide:n.indexOf(t)},n.map((function(e,n){return c.a.createElement("div",{key:e,className:q.a.block},c.a.createElement("div",{className:q.a.row},c.a.createElement("p",null,e),c.a.createElement(V,{prefix:u===O.currencyFrom?"-":"+",name:u,inputValue:i,onChange:o})),c.a.createElement("div",{className:q.a.row},c.a.createElement("p",{className:q.a.text}," ",Y(J.ExchangeBlock.balanceText,{balance:H(e,L(l))}))),r&&u===O.currencyTo&&c.a.createElement("div",{className:A()(q.a.row,q.a.row_rate)},c.a.createElement("p",{className:A()(q.a.text,q.a.text_rate)},s)),!r&&u===O.currencyTo&&!m&&c.a.createElement("div",{className:A()(q.a.row,q.a.row_rate)},c.a.createElement("span",{className:q.a.error},J.ExchangeBlock.getRateError)))}))))},z=r(42),$=r.n(z),K=function(e){e.type;var n=e.hasLoader,r=void 0!==n&&n,t=e.disabled,a=void 0!==t&&t,o=e.className,u=e.title,i=e.onClick,l=e.children;return c.a.createElement("button",{className:A()($.a.button,o),disabled:a,onClick:i,title:u,"aria-label":u},r?c.a.createElement("svg",{width:15,height:15,version:"1.1",x:"0",y:"0",className:$.a.loader,viewBox:"0 0 100 100"},c.a.createElement("circle",{className:$.a.circle,cx:"50",cy:"50",r:"44"})):l)},ee=r(43),ne=r(44),re=r.n(ne),te=function(e){var n=e.currencyTo,r=e.currencyFrom,t=e.handleCurrencyFromChange,a=e.handleCurrencyToChange,o=e.handleCurrencyValueChange,u=e.handleExchange,i=e.rate,l=e.valueFrom,s=e.valueTo,d=e.isRateLoading,m=e.balanceFrom,E=e.balanceTo,f=e.isExchangeButtonDisabled,y=Y(ee.ExchangeWidget.currencyRateText,{currencyTo:"".concat(I[n]),currencyFrom:"".concat(I[r]).concat(L(i))});return c.a.createElement("section",{className:re.a.root},c.a.createElement("div",{className:re.a.content},c.a.createElement(Z,{balance:m,onCurrencyChange:function(e){return t(e)},currency:r,type:O.currencyFrom,currencyItems:F,onCurrencyValueChange:o,inputValue:String(l),currencyAmountStr:y}),c.a.createElement(Z,{rate:i,balance:E,onCurrencyChange:function(e){return a(e)},currency:n,type:O.currencyTo,currencyItems:F,onCurrencyValueChange:o,inputValue:String(s),currencyAmountStr:y,isRateLoading:d})),c.a.createElement(K,{disabled:f,className:re.a.submitBtn,onClick:u,title:ee.ExchangeWidget.buttonTitle},ee.ExchangeWidget.buttonText))},ae=function(e,n,r,t){var c=Object(a.useState)(r),o=Object(j.a)(c,2),u=o[0],i=o[1],l=Object(a.useState)(""),s=Object(j.a)(l,2),d=s[0],f=s[1],y=Object(a.useState)(!1),b=Object(j.a)(y,2),_=b[0],g=b[1],h=Object(a.useState)(!1),p=Object(j.a)(h,2),v=p[0],S=p[1],T=Object(a.useState)(""),x=Object(j.a)(T,2),C=x[0],R=x[1];Object(a.useEffect)((function(){if(C){var e=C===O.currencyFrom?1/t:t,n=C===O.currencyFrom?u.currencyFrom:u.currencyTo;if(n&&e){var r=function(e,n){return Math.round(e*n*100)/100}(e,n),a=C===O.currencyFrom?O.currencyTo:O.currencyFrom;i((function(e){return Object(E.a)({},e,Object(m.a)({},a,r))}))}}}),[C,t,u.currencyFrom,u.currencyTo]);var N=Object(a.useCallback)((function(){var e=n(),r=e.isValid,t=e.errorMessage,a=void 0===t?"":t;if(!r)return f(a),a}),[n]),F=Object(a.useCallback)((function(e,n){R(n),i((function(r){return Object(E.a)({},r,Object(m.a)({},n,e))}))}),[]),I=Object(a.useCallback)((function(n){var r=N();r?(S(!1),e.error(n,r),g(!1)):(S(!1),e.success(n),g(!0))}),[N,e]);return Object(a.useMemo)((function(){return{handleChange:F,handleExchange:I,setForm:i,form:u,errorMessage:d,submitting:v,success:_,updateFieldName:C}}),[F,I,d,_,u,C,v])},ce={currencyFrom:null,currencyTo:null},oe=function(){var e=Object(i.c)(),n=Object(a.useRef)({}),r=Object(a.useState)(F[0]),t=Object(j.a)(r,2),o=t[0],u=t[1],l=Object(a.useState)(F[2]),s=Object(j.a)(l,2),d=s[0],m=s[1],E=Object(i.d)((function(e){return e.rates}),i.b),f=Object(i.d)((function(e){return e.userBalance}),i.b),y=E[d],g=y&&y.loaded&&y.rates[o];console.log("currencyFromRate",g);var h=ae({success:function(n){var r;e((r={currencyFrom:o,currencyTo:d,form:p},{type:b.EXCHANGE_MONEY,payload:r})),e(S([{text:"Exchange success!",variant:"success"}]))},error:function(n,r){e(S([{text:r,variant:"error"}]))}},(function(){return function(e){var n=e.currencyFrom,r=e.valueFrom,t=e.userBalance;return r?r>t[n]?{isValid:!1,errorMessage:"You do not have enough money in your account"}:{isValid:!0}:{isValid:!1,errorMessage:"No values for exchange"}}({currencyFrom:o,valueFrom:p.currencyFrom,userBalance:f})}),ce,g),p=h.form,v=h.handleChange,O=h.handleExchange;Object(a.useEffect)((function(){var r=n.current;return function n(){r.timerId&&clearTimeout(r.timerId),e(_(d)),r.timerId=setTimeout((function(){n()}),1e4)}(),function(){return clearTimeout(r.timerId)}}),[d,e]);var T=function(e,n){return function(e){var n=e.currentIndex,r=e.prevIndex;return(F.length+n+(n>r?-1:1))%F.length}({currentIndex:F.indexOf(e),prevIndex:F.indexOf(n)})};return c.a.createElement(te,{currencyTo:d,currencyFrom:o,valueFrom:p.currencyFrom,valueTo:p.currencyTo,balanceFrom:f[o],balanceTo:f[d],handleCurrencyValueChange:v,handleCurrencyToChange:function(e){if(m(e),e===o){var n=T(o,e);u(F[n])}},handleCurrencyFromChange:function(e){if(u(e),e===d){var n=T(d,e);m(F[n])}},isRateLoading:Boolean(y)&&y.loading,rate:g,handleExchange:O,isExchangeButtonDisabled:!p.currencyFrom||!p.currencyTo||!g})},ue=function(){var e=Object(N.useSnackbar)(),n=e.enqueueSnackbar,r=e.closeSnackbar,t=Object(i.d)((function(e){return e.notifications}),i.b),c=Object(i.c)();return Object(a.useEffect)((function(){if(t.length>0){var e=!0,r=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(e=(o=u.next()).done);e=!0){var i=o.value,l=i.text,s=i.variant;n(l,{variant:s})}}catch(d){r=!0,a=d}finally{try{e||null==u.return||u.return()}finally{if(r)throw a}}c({type:p.RESET_NOTIFICATIONS,payload:[]})}}),[t,c,r,n]),null},ie=r(51),le=r.n(ie);r(134),r(135);u.a.render(c.a.createElement((function(){return c.a.createElement(i.a,{store:R},c.a.createElement(N.SnackbarProvider,{maxSnack:3},c.a.createElement(ue,null),c.a.createElement("div",{className:le.a.container},c.a.createElement("div",{className:le.a.contentWrapper},c.a.createElement(oe,null)))))}),null),document.getElementById("root"))},42:function(e,n,r){e.exports={button:"button_button__2CF7H",loader:"button_loader__1FtDE","spinner-rotate":"button_spinner-rotate__S7X1o",circle:"button_circle__3bYBt","spinner-offset":"button_spinner-offset__1t0Iz"}},43:function(e){e.exports=JSON.parse('{"ExchangeWidget":{"buttonText":"Exchange money","buttonTitle":"Exchange","currencyRateText":"%currencyTo%1 = %currencyFrom%"}}')},44:function(e,n,r){e.exports={root:"exchange-widget-view_root__2rR-E",content:"exchange-widget-view_content__tvriG",submitBtn:"exchange-widget-view_submitBtn__15EI2"}},50:function(e){e.exports=JSON.parse('{"ExchangeBlock":{"balanceText":"You have\xa0%balance%","getRateError":"Failed to get rate"}}')},51:function(e,n,r){e.exports={container:"app_container__O5cx8",contentWrapper:"app_contentWrapper__1h9GT"}},7:function(e,n,r){e.exports={root_currencyFrom:"exchange-block_root_currencyFrom__kT5ap",root_currencyTo:"exchange-block_root_currencyTo__3UXG2",row:"exchange-block_row__17_XV",row_rate:"exchange-block_row_rate__nyxy4",block:"exchange-block_block__yBRUZ",text:"exchange-block_text__2m35k",text_rate:"exchange-block_text_rate__diRTm",error:"exchange-block_error__1Z3ej"}},72:function(e){e.exports=JSON.parse('{"RUB":100000.292992992,"USD":205.2,"GBP":20,"EUR":200}')},74:function(e,n,r){e.exports={input:"number-format-input_input__2ITC6"}},76:function(e,n,r){e.exports={slide:"slider_slide__1nptA"}},81:function(e,n,r){e.exports=r(136)}},[[81,1,2]]]);
//# sourceMappingURL=main.730ab46c.chunk.js.map